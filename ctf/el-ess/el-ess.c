//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2017 Retargetable Decompiler <info@retdec.com>
//

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

// ------------------------ Structures ------------------------

struct _IO_FILE {
    int32_t e0;
};

// --------------------- Global Variables ---------------------

struct _IO_FILE * g1 = NULL; // 0x804a034

// ------------------------ Functions -------------------------

// Address range: 0x804859b - 0x80487bf
int main(int argc, char ** argv) {
    int32_t v1 = *(int32_t *)20; // 0x80485ae
    int32_t str = 0; // bp-120
    setbuf(g1, NULL);
    str = 0x6e69622f;
    puts("============================================================");
    puts("EL-ESS -- a drop-in replacement for ls");
    puts("============================================================");
    printf("Enter path: ");
    int32_t v2;
    scanf("%16s", &v2);
    int32_t v3 = strlen((char *)&str) + (int32_t)&str; // 0x804864b
    char * v4 = (char *)v3;
    int32_t v5 = 0;
    // branch -> 0x8048733
    char * v6;
    while (true) {
        char * v7 = (char *)(v5 + (int32_t)&v2);
        char v8 = *v7; // 0x804873e
        char v9 = v8; // 0x804871c
        char * v10 = v4;
        switch (v8) {
            case 0: {
                // 0x8048749
                *v4 = 0;
                strlen((char *)&str);
                system((char *)&str);
                if (*(int32_t *)20 != v1) {
                    // 0x80487ab
                    __stack_chk_fail();
                    // branch -> 0x80487b0
                }
                // 0x80487b0
                return 0;
            }
            case 39: {
                // 0x80486f0
                *v4 = 92;
                // branch -> 0x8048702
                v9 = *v7;
                v10 = (char *)(v3 + 1);
            }
            default: {
              lab_0x8048702_7:;
                int32_t v11 = (int32_t)v10 + 1; // 0x8048708
                *v10 = v9;
                int32_t v12 = v5 + 1; // 0x8048721
                v6 = (char *)v11;
                if (v12 > 15) {
                    // break (via goto) -> 0x8048749
                    goto lab_0x8048749;
                }
                v4 = v6;
                v5 = v12;
                v3 = v11;
                // continue -> 0x8048733
                continue;
            }
            case 34: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
            case 96: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
            case 36: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
            case 59: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
            case 124: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
            case 60: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
            case 62: {
                // 0x80486f0
                *v4 = 92;
                v9 = *v7;
                v10 = (char *)(v3 + 1);
                // branch -> 0x8048702
                goto lab_0x8048702_7;
            }
        }
    }
  lab_0x8048749:
    // 0x8048749
    *v6 = 0;
    strlen((char *)&str);
    system((char *)&str);
    if (*(int32_t *)20 != v1) {
        // 0x80487ab
        __stack_chk_fail();
        // branch -> 0x80487b0
    }
    // 0x80487b0
    return 0;
}

// --------------- Dynamically Linked Functions ---------------

// void __stack_chk_fail(void);
// int printf(const char * restrict format, ...);
// int puts(const char * s);
// int scanf(const char * restrict format, ...);
// void setbuf(FILE * restrict stream, char * restrict buf);
// size_t strlen(const char * s);
// int system(const char * command);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (5.4.0)
// Detected functions: 1
// Decompiler release: v2.2.1 (2016-09-07)
// Decompilation date: 2017-07-02 14:09:58
